<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Giphy Search</title>
  <style type="text/css">
    button,
    div,
    form,
    input {
      margin: 10px;
    }


.gif img 
{

    max-width: 300px;
    height: 200px;
    object-fit: fill;
    overflow: hidden;
}
  </style>



  <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">


</head>

<body>

  <div class="container">
    <h1>Giphy Search</h1>

    <!-- buttons will get dumped here -->
    <div id="button-tab"></div>

    <form id="button-form">
      <button-name for="button-input">Add a Giphy Search</button-name>
      <input type="text" id="button-input"><br>

      <!-- Button triggers new movie to be added -->
      <input id="add-button" type="submit" value="Add a button">
    </form>



<div class="container">
        <div class="row">
        <div class="gallery col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h1 class="gallery-title">results</h1>
        </div>




            <div class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still" id="box1">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>

            <div  class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still" id="box2">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>

            <div  class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still" id="box3">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>

            <div  class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still" id="box4">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>

            <div  class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still" id="box5">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>

            <div  class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still" id="box6">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>

            <div  class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still" id="box7">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>

            <div  class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still" id="box8">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>

            <div  class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still"  id="box9">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>

            <div  class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still" id="box10">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>

            <div  class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still" id="box11">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>

            <div  class="gif gallery_product col-lg-3 col-md-3 col-sm-3 col-xs-6" data-still="null" data-animate="null" data-state="still" id="box12">
                <img src="http://fakeimg.pl/365x365/" class="img-responsive">
            </div>
        </div>
    </div>
</section>



    <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>


    <script type="text/javascript">



      // Initial array of search terms
      var prebuttons = ["Bill Nye", "Jurassic Park", "Cosmos", "Tesla"];

      // Function for displaying buttons on top
      function renderButtons() {

        // Deleting the movie buttons prior to adding new movie buttons
        // (this is necessary otherwise we will have repeat buttons)
        $("#button-tab").empty();

        // Looping through the array of movies
        for (var i = 0; i < prebuttons.length; i++) {

          // Then dynamicaly generating buttons for each movie in the array.
          // This code $("<button>") is all jQuery needs to create the start and end tag. (<button></button>)
          var a = $("<button>");
          // Adding a class
          a.addClass("clickbutton");
          // a.addClass("");


          
          // Adding a data-attribute with a value of the movie at index i
          a.attr("data-button-name", prebuttons[i]);
          // Providing the button's text with a value of the movie at index i
          a.text(prebuttons[i]);
          // Adding the button to the HTML

          console.log(a);
          $("#button-tab").append(a);
        }
      }

      // This function handles events where add button is clicked
      $("#add-button").on("click", function(event) {

        event.preventDefault();


        // This line will grab the text from the input box
        var usersearch = $("#button-input").val().trim();
        // The movie from the textbox is then added to our array
        prebuttons.push(usersearch);

        console.log("add button now." + usersearch);
        console.log(prebuttons);
        // calling renderButtons which handles the processing of our movie array
        renderButtons();
      });


      // Calls the Giphy API when a button is pressed
 $(document).on("click", ".clickbutton", function(){
        console.log("button clicked.");
        console.log(this);
        var SearchTerm = ($(this).attr("data-button-name"));
        console.log(SearchTerm)


        var queryURL = 'http://api.giphy.com/v1/gifs/search?q=' + SearchTerm + '&limit=12&api_key=dc6zaTOxFJmzC';


        $.ajax({
            url: queryURL,
            method: 'GET'
          }).done(function(response) {
            console.log(response);
           // console.log(response.images.url);
            console.log(response.data[0].images.fixed_height.url);
            console.log(queryURL);


              for (var i = 0; i < 12; i++) 
              {
                    $('#box'+ (i+1) ).html('<img src="' + response.data[i].images.downsized_still.url + ' " > <br> <h5> Rating:' + response.data[i].rating + '</h5>');
                    // $('#box'+ (i+1) ).val = response.data[i].images.downsized.url;
                           $('#box'+ (i+1) ).attr("data-animate", response.data[i].images.downsized.url);
                           $('#box'+ (i+1) ).attr("data-still", response.data[i].images.downsized_still.url);
                           $('#box'+ (i+1) ).attr("rating", response.data[i].rating);
                           console.log(response.data[i].rating);

                    // console.log($('#box'+ (i+1)).val()); 
              }

          });
       }); // end 

//animates the gif on click

   $(".gif").on("click", function() {

    console.log("Gif clicked");
    console.log(this);
    console.log($(this).attr("data-state"));


      var state = $(this).attr("data-state");
      // console.log(state);
      var animated =  $(this).attr("data-animate");
      var stilled =  $(this).attr("data-still");
      var rating = $(this).attr("rating");
      // If the clicked image's state is still, update its src attribute to what its data-animate value is.
      // Then, set the image's data-state to animate
      // Else set src to the data-still value

      if (state === "still") {
        // $(this).attr("src", $(this).attr("data-animate"));
        $(this).attr("data-state", "animate");
        $(this).html('<img src="' + animated + '">  <br> <h5> Rating:' + rating + '</h5> ');
        console.log(animated + "ANIMATED");
        console.log(rating);
        console.log($(this).attr("data-animate"));
      } else {
        $(this).attr("src", $(this).attr("data-still"));
        $(this).attr("data-state", "still");
       $(this).html('<img src="' + stilled + '">  <br> <h5> Rating:' + rating + '</h5> ');
        console.log("STILL");
      }
    });


      // Calling the renderButtons function at least once to display the initial list of search terms
      renderButtons();

    </script>

  </div>

  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</body>

</html>